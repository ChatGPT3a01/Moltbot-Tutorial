<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skill æ•™å­¸ - ç£ç¢Ÿç›¤é»å·¥å…· (disk-audit)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); min-height: 100vh; overflow: hidden; color: #333; }
        .nav-bar { position: fixed; top: 0; left: 0; right: 0; height: 60px; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(12px); display: flex; justify-content: space-between; align-items: center; padding: 0 30px; z-index: 10000; }
        .nav-title { font-size: 22px; font-weight: 700; color: #fff; }
        .nav-buttons { display: flex; gap: 12px; flex-wrap: wrap; }
        .nav-btn { background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.4); color: white; padding: 6px 16px; border-radius: 20px; cursor: pointer; font-size: 14px; font-weight: 600; text-decoration: none; }
        .nav-btn:hover { background: rgba(255, 255, 255, 0.4); }
        .nav-arrow { position: fixed; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.25); color: white; width: 60px; height: 60px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.4); font-size: 24px; cursor: pointer; z-index: 9000; display: flex; align-items: center; justify-content: center; }
        .prev-arrow { left: 30px; } .next-arrow { right: 30px; }
        .nav-arrow:disabled { opacity: 0.3; }
        .slide { position: absolute; top: 60px; left: 0; width: 100%; height: calc(100vh - 60px); display: none; align-items: center; justify-content: center; padding: 40px; }
        .slide.active { display: flex; }
        .content-card { background: rgba(255, 255, 255, 0.98); border-radius: 24px; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3); padding: 40px; max-width: 1200px; width: 95%; max-height: 88vh; overflow-y: auto; }
        h1 { color: #f5576c; font-size: 42px; margin-bottom: 20px; text-align: center; }
        h2 { color: #f093fb; font-size: 28px; margin-bottom: 20px; border-bottom: 3px solid #f5576c; padding-bottom: 10px; }
        h3 { color: #f5576c; font-size: 20px; margin: 15px 0 10px 0; }
        p, li { font-size: 17px; line-height: 1.7; color: #444; margin-bottom: 10px; }
        code { background: #f0f2f5; padding: 3px 8px; border-radius: 6px; font-family: 'Consolas', monospace; color: #d63384; font-weight: 600; }
        pre { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 12px; margin: 15px 0; font-size: 14px; overflow-x: auto; white-space: pre-wrap; }
        .box { padding: 15px; border-radius: 12px; margin: 15px 0; border-left: 6px solid; font-size: 16px; }
        .info { background: #e3f2fd; border-color: #2196f3; color: #0d47a1; }
        .success { background: #d4edda; border-color: #28a745; color: #155724; }
        .warning { background: #fff3cd; border-color: #ffc107; color: #856404; }
        .highlight { background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%); padding: 4px 12px; border-radius: 6px; font-weight: bold; color: white; }
        .step-box { background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(245, 87, 108, 0.1)); padding: 20px; border-radius: 15px; margin: 15px 0; border: 2px solid rgba(245, 87, 108, 0.3); }
        .step-number { display: inline-block; background: linear-gradient(135deg, #f093fb, #f5576c); color: white; width: 36px; height: 36px; border-radius: 50%; text-align: center; line-height: 36px; font-weight: bold; margin-right: 12px; }
        .indicators { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; z-index: 4000; padding: 10px 20px; background: rgba(0,0,0,0.3); border-radius: 30px; }
        .dot { width: 12px; height: 12px; background: rgba(255,255,255,0.4); border-radius: 50%; cursor: pointer; }
        .dot.active { background: #fff; transform: scale(1.3); }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 2px solid #ddd; padding: 12px; text-align: left; }
        th { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
        tr:nth-child(even) { background: #f8f9fa; }
    </style>
</head>
<body>
    <div class="nav-bar">
        <div class="nav-title">ğŸ“ Skill æ•™å­¸ - ç£ç¢Ÿç›¤é»å·¥å…·</div>
        <div class="nav-buttons">
            <a href="index.html" class="nav-btn">ğŸ  é¦–é </a>
            <a href="Skill-GoogleDrive.html" class="nav-btn">ä¸‹ä¸€å€‹ Skill â¡ï¸</a>
            <button class="nav-btn" onclick="toggleFullscreen()">ğŸ–¥ï¸ å…¨è¢å¹•</button>
        </div>
    </div>

    <div class="slide-container">
        <!-- å°é¢ -->
        <div class="slide active">
            <div class="content-card" style="text-align: center;">
                <span style="font-size: 80px;">ğŸ“</span>
                <h1>disk-audit Skill</h1>
                <h2 style="border: none; font-size: 24px; color: #666;">ç£ç¢Ÿå¸¸æ…‹ç›¤é»/æ•´ç†å·¥å…·</h2>
                <div style="margin-top: 25px; display: flex; gap: 12px; flex-wrap: wrap; justify-content: center;">
                    <span class="highlight">æ‰¾å¤§æª”æ¡ˆ</span>
                    <span class="highlight">æœ€è¿‘ä¿®æ”¹</span>
                    <span class="highlight">å‰¯æª”åçµ±è¨ˆ</span>
                    <span class="highlight">é‡è¤‡æª”åµæ¸¬</span>
                </div>
                <p style="margin-top: 30px; font-size: 18px;">è®“é¾è¦å¹«ä½ è‡ªå‹•ç›¤é»é›»è…¦è£¡çš„æª”æ¡ˆï¼</p>
            </div>
        </div>

        <!-- åŠŸèƒ½ä»‹ç´¹ -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸ¯ é€™å€‹ Skill èƒ½åšä»€éº¼ï¼Ÿ</h2>
                <div class="step-box">
                    <p><span class="step-number">1</span><strong>Top å¤§æª”</strong> - æ‰¾å‡ºä½”ç”¨ç©ºé–“æœ€å¤šçš„æª”æ¡ˆï¼ˆé è¨­ Top 30ï¼‰</p>
                </div>
                <div class="step-box">
                    <p><span class="step-number">2</span><strong>æœ€è¿‘ä¿®æ”¹</strong> - åˆ—å‡ºæœ€è¿‘ä¿®æ”¹çš„æª”æ¡ˆï¼ˆTop 30ï¼‰</p>
                </div>
                <div class="step-box">
                    <p><span class="step-number">3</span><strong>å‰¯æª”åçµ±è¨ˆ</strong> - çµ±è¨ˆå„ç¨®å‰¯æª”åçš„ç¸½å®¹é‡ï¼ˆTop 30ï¼‰</p>
                </div>
                <div class="step-box">
                    <p><span class="step-number">4</span><strong>é‡è¤‡æª”åµæ¸¬</strong> - ç”¨ SHA256 é›œæ¹Šæ‰¾å‡ºé‡è¤‡çš„æª”æ¡ˆ</p>
                </div>
                <div class="box info">
                    <strong>ğŸ’¡ ä½¿ç”¨æ–¹å¼ï¼š</strong>è¨­å®šå¥½ä¹‹å¾Œï¼Œåªè¦è·Ÿé¾è¦èªªã€Œè·‘ç£ç¢Ÿç›¤é»ã€å°±æœƒè‡ªå‹•ç”¢å‡ºå ±å‘Šï¼
                </div>
            </div>
        </div>

        <!-- å»ºç«‹ Skill çµæ§‹ -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸ“‚ ç¬¬ä¸€æ­¥ï¼šå»ºç«‹ Skill è³‡æ–™å¤¾çµæ§‹</h2>
                <p>åœ¨ PowerShell åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œå»ºç«‹ skill è³‡æ–™å¤¾ï¼š</p>
                <pre># å»ºç«‹ skill è³‡æ–™å¤¾çµæ§‹
mkdir "$env:USERPROFILE\.openclaw\workspace\skills\disk-audit\scripts" -Force

# å»ºç«‹å ±å‘Šè¼¸å‡ºè³‡æ–™å¤¾
mkdir "$env:USERPROFILE\.openclaw\workspace\reports\disk-audit" -Force</pre>
                <div class="box success">
                    <strong>ğŸ“ è³‡æ–™å¤¾çµæ§‹ï¼š</strong><br>
                    <code>.openclaw/workspace/skills/disk-audit/</code> - Skill ä¸»è³‡æ–™å¤¾<br>
                    <code>.openclaw/workspace/skills/disk-audit/scripts/</code> - è…³æœ¬è³‡æ–™å¤¾<br>
                    <code>.openclaw/workspace/reports/disk-audit/</code> - å ±å‘Šè¼¸å‡ºè³‡æ–™å¤¾
                </div>
            </div>
        </div>

        <!-- å»ºç«‹ SKILL.md -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸ“ ç¬¬äºŒæ­¥ï¼šå»ºç«‹ SKILL.md</h2>
                <p>åœ¨ <code>disk-audit</code> è³‡æ–™å¤¾å»ºç«‹ <code>SKILL.md</code> æª”æ¡ˆï¼š</p>
                <pre># disk-audit

ç£ç¢Ÿå¸¸æ…‹ç›¤é»/æ•´ç†å·¥å…·

## åŠŸèƒ½
- æƒææŒ‡å®šè³‡æ–™å¤¾ï¼Œç”¢å‡ºç›¤é»å ±å‘Š
- æ‰¾å‡ºå¤§æª”æ¡ˆã€æœ€è¿‘ä¿®æ”¹ã€å‰¯æª”åçµ±è¨ˆã€é‡è¤‡æª”

## è¨­å®š
- æƒæç¯„åœï¼šC:\Users\user\Downloads + C:\Users\user\Desktop
- å¤§æª”é–€æª»ï¼š500MB
- æ’ç¨‹ï¼šæ‰‹å‹•åŸ·è¡Œï¼ˆèªªã€Œè·‘ç£ç¢Ÿç›¤é»ã€ï¼‰

## ä½¿ç”¨æ–¹å¼
è·Ÿé¾è¦èªªï¼šã€Œè·‘ç£ç¢Ÿç›¤é»ã€

## å ±å‘Šä½ç½®
.openclaw/workspace/reports/disk-audit/YYYY-MM-DD.md</pre>
                <div class="box info">
                    <strong>ğŸ’¡ æç¤ºï¼š</strong>ä½ å¯ä»¥æ ¹æ“šéœ€æ±‚ä¿®æ”¹æƒæç¯„åœå’Œå¤§æª”é–€æª»ï¼
                </div>
            </div>
        </div>

        <!-- å»ºç«‹æƒæè…³æœ¬ Part 1 -->
        <div class="slide">
            <div class="content-card">
                <h2>âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šå»ºç«‹æƒæè…³æœ¬ (1/2)</h2>
                <p>åœ¨ <code>scripts</code> è³‡æ–™å¤¾å»ºç«‹ <code>scan.ps1</code>ï¼š</p>
                <pre># disk-audit scan.ps1
# ç£ç¢Ÿç›¤é»æƒæè…³æœ¬

param(
    [string[]]$ScanPaths = @(
        "$env:USERPROFILE\Downloads",
        "$env:USERPROFILE\Desktop"
    ),
    [int]$LargeFileMB = 500,
    [int]$TopN = 30
)

$reportDate = Get-Date -Format "yyyy-MM-dd"
$reportPath = "$env:USERPROFILE\.openclaw\workspace\reports\disk-audit\$reportDate.md"

# æ’é™¤çš„ç³»çµ±è³‡æ–™å¤¾
$excludeDirs = @("Windows", "Program Files", "Program Files (x86)",
                 '$Recycle.Bin', "node_modules", ".git")

Write-Host "é–‹å§‹æƒæ..." -ForegroundColor Cyan</pre>
            </div>
        </div>

        <!-- å»ºç«‹æƒæè…³æœ¬ Part 2 -->
        <div class="slide">
            <div class="content-card">
                <h2>âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šå»ºç«‹æƒæè…³æœ¬ (2/2)</h2>
                <pre># å–å¾—æ‰€æœ‰æª”æ¡ˆ
$allFiles = @()
foreach ($path in $ScanPaths) {
    if (Test-Path $path) {
        $allFiles += Get-ChildItem -Path $path -Recurse -File -ErrorAction SilentlyContinue |
            Where-Object {
                $dominated = $false
                foreach ($ex in $excludeDirs) {
                    if ($_.FullName -like "*\$ex\*") { $dominated = $true; break }
                }
                -not $dominated
            }
    }
}

# ç”¢ç”Ÿå ±å‘Š
$report = "# ç£ç¢Ÿç›¤é»å ±å‘Š - $reportDate`n`n"

# Top å¤§æª”
$report += "## Top $TopN å¤§æª”æ¡ˆ`n"
$largeFiles = $allFiles | Sort-Object Length -Descending | Select-Object -First $TopN
foreach ($f in $largeFiles) {
    $sizeMB = [math]::Round($f.Length / 1MB, 2)
    $report += "- $sizeMB MB - $($f.FullName)`n"
}

# å„²å­˜å ±å‘Š
$report | Out-File -FilePath $reportPath -Encoding UTF8
Write-Host "å ±å‘Šå·²ç”¢ç”Ÿï¼š$reportPath" -ForegroundColor Green</pre>
            </div>
        </div>

        <!-- è¨­å®šèªªæ˜ -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸ”§ è¨­å®šåƒæ•¸èªªæ˜</h2>
                <table>
                    <tr><th>åƒæ•¸</th><th>èªªæ˜</th><th>é è¨­å€¼</th></tr>
                    <tr>
                        <td><code>$ScanPaths</code></td>
                        <td>è¦æƒæçš„è³‡æ–™å¤¾è·¯å¾‘ï¼ˆå¯å¤šå€‹ï¼‰</td>
                        <td>Downloads + Desktop</td>
                    </tr>
                    <tr>
                        <td><code>$LargeFileMB</code></td>
                        <td>å¤§æª”é–€æª»ï¼ˆå¤šå°‘ MB ç®—å¤§æª”ï¼‰</td>
                        <td>500 MB</td>
                    </tr>
                    <tr>
                        <td><code>$TopN</code></td>
                        <td>é¡¯ç¤ºå‰å¹¾å</td>
                        <td>30</td>
                    </tr>
                    <tr>
                        <td><code>$excludeDirs</code></td>
                        <td>æ’é™¤çš„è³‡æ–™å¤¾</td>
                        <td>Windows, node_modules ç­‰</td>
                    </tr>
                </table>
                <div class="box warning">
                    <strong>âš ï¸ æ³¨æ„ï¼š</strong>æƒæå…¨æ©Ÿæœƒæ¯”è¼ƒæ…¢ï¼Œå»ºè­°å…ˆæŒ‡å®šç‰¹å®šè³‡æ–™å¤¾æ¸¬è©¦ã€‚
                </div>
            </div>
        </div>

        <!-- å¦‚ä½•ä½¿ç”¨ -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸš€ å¦‚ä½•ä½¿ç”¨</h2>
                <h3>æ–¹æ³•ä¸€ï¼šç›´æ¥è·Ÿé¾è¦èªª</h3>
                <pre>è·‘ç£ç¢Ÿç›¤é»</pre>
                <p>é¾è¦æœƒè‡ªå‹•åŸ·è¡Œ <code>scan.ps1</code> ä¸¦ç”¢å‡ºå ±å‘Šã€‚</p>

                <h3>æ–¹æ³•äºŒï¼šæ‰‹å‹•åŸ·è¡Œè…³æœ¬</h3>
                <pre># åœ¨ PowerShell åŸ·è¡Œ
& "$env:USERPROFILE\.openclaw\workspace\skills\disk-audit\scripts\scan.ps1"</pre>

                <h3>æ–¹æ³•ä¸‰ï¼šæŒ‡å®šæƒæè·¯å¾‘</h3>
                <pre># æƒæ D æ§½çš„ Videos è³‡æ–™å¤¾
& "$env:USERPROFILE\.openclaw\workspace\skills\disk-audit\scripts\scan.ps1" `
    -ScanPaths @("D:\Videos") -LargeFileMB 1000</pre>
            </div>
        </div>

        <!-- å ±å‘Šç¯„ä¾‹ -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸ“Š å ±å‘Šç¯„ä¾‹</h2>
                <pre># ç£ç¢Ÿç›¤é»å ±å‘Š - 2026-02-05

## Top 30 å¤§æª”æ¡ˆ
- 4521.32 MB - D:\Videos\movie.mkv
- 2103.45 MB - C:\Users\user\Downloads\software.iso
- 1892.11 MB - D:\Backup\archive.zip
- 856.23 MB - C:\Users\user\Desktop\presentation.pptx
...

## æœ€è¿‘ä¿®æ”¹ Top 30
- 2026-02-05 10:30 - C:\Users\user\Documents\report.docx
- 2026-02-05 09:15 - C:\Users\user\Downloads\data.xlsx
...

## å‰¯æª”åå®¹é‡çµ±è¨ˆ
| å‰¯æª”å | ç¸½å®¹é‡ | æª”æ¡ˆæ•¸ |
|--------|--------|--------|
| .mkv   | 15.2 GB | 12 |
| .mp4   | 8.7 GB  | 45 |
| .zip   | 3.2 GB  | 28 |</pre>
            </div>
        </div>

        <!-- é€²éšï¼šé‡è¤‡æª”åµæ¸¬ -->
        <div class="slide">
            <div class="content-card">
                <h2>ğŸ” é€²éšåŠŸèƒ½ï¼šé‡è¤‡æª”åµæ¸¬</h2>
                <p>åœ¨ <code>scan.ps1</code> åŠ å…¥ä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š</p>
                <pre># é‡è¤‡æª”åµæ¸¬ï¼ˆç”¨æª”æ¡ˆå¤§å°åˆ†çµ„ï¼Œå†ç”¨ SHA256 æ¯”å°ï¼‰
$report += "`n## å¯èƒ½çš„é‡è¤‡æª”æ¡ˆ`n"

$sizeGroups = $allFiles | Group-Object Length | Where-Object { $_.Count -gt 1 }
$duplicates = @()

foreach ($group in $sizeGroups | Select-Object -First 50) {
    $hashes = @{}
    foreach ($file in $group.Group) {
        $hash = (Get-FileHash $file.FullName -Algorithm SHA256).Hash
        if ($hashes.ContainsKey($hash)) {
            $duplicates += [PSCustomObject]@{
                Hash = $hash
                File1 = $hashes[$hash]
                File2 = $file.FullName
                Size = $file.Length
            }
        } else {
            $hashes[$hash] = $file.FullName
        }
    }
}

foreach ($dup in $duplicates) {
    $sizeMB = [math]::Round($dup.Size / 1MB, 2)
    $report += "- [$sizeMB MB] é‡è¤‡ï¼š`n"
    $report += "  - $($dup.File1)`n"
    $report += "  - $($dup.File2)`n"
}</pre>
            </div>
        </div>

        <!-- å®Œæˆ -->
        <div class="slide">
            <div class="content-card" style="text-align: center;">
                <span style="font-size: 80px;">ğŸ‰</span>
                <h2 style="border: none;">disk-audit Skill å®Œæˆï¼</h2>
                <p style="font-size: 20px; margin: 20px 0;">ç¾åœ¨ä½ å¯ä»¥è·Ÿé¾è¦èªªã€Œè·‘ç£ç¢Ÿç›¤é»ã€ä¾†ç”¢ç”Ÿå ±å‘Šäº†ï¼</p>
                <div class="box success" style="text-align: left;">
                    <strong>ğŸ“‹ å¿«é€Ÿè¤‡ç¿’ï¼š</strong><br>
                    1. å»ºç«‹è³‡æ–™å¤¾çµæ§‹<br>
                    2. å»ºç«‹ SKILL.md èªªæ˜æª”<br>
                    3. å»ºç«‹ scan.ps1 æƒæè…³æœ¬<br>
                    4. è·Ÿé¾è¦èªªã€Œè·‘ç£ç¢Ÿç›¤é»ã€
                </div>
                <a href="Skill-GoogleDrive.html" style="display: inline-block; margin-top: 30px; font-size: 18px; padding: 20px 40px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; text-decoration: none; border-radius: 50px;">
                    â¡ï¸ ä¸‹ä¸€å€‹ Skillï¼šGoogle Drive ä¸Šå‚³
                </a>
            </div>
        </div>
    </div>

    <button class="nav-arrow prev-arrow" id="prevBtn" onclick="changeSlide(-1)">â®</button>
    <button class="nav-arrow next-arrow" id="nextBtn" onclick="changeSlide(1)">â¯</button>
    <div class="indicators" id="indicatorContainer"></div>

    <script>
        let currentSlide = 0; const slides = document.querySelectorAll('.slide'); const totalSlides = slides.length;
        function init() { createIndicators(); showSlide(0); document.addEventListener('keydown', e => { if (e.key === 'ArrowLeft') changeSlide(-1); if (e.key === 'ArrowRight') changeSlide(1); }); }
        function createIndicators() { const c = document.getElementById('indicatorContainer'); slides.forEach((_, i) => { const d = document.createElement('div'); d.className = 'dot'; d.onclick = () => goToSlide(i); c.appendChild(d); }); }
        function showSlide(i) { if (i < 0) i = 0; if (i >= totalSlides) i = totalSlides - 1; slides.forEach(s => s.classList.remove('active')); slides[i].classList.add('active'); currentSlide = i; document.querySelectorAll('.dot').forEach((d, j) => d.classList.toggle('active', j === i)); document.getElementById('prevBtn').disabled = i === 0; document.getElementById('nextBtn').disabled = i === totalSlides - 1; }
        function changeSlide(d) { showSlide(currentSlide + d); }
        function goToSlide(i) { showSlide(i); }
        function toggleFullscreen() { if (!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen(); }
        init();
    </script>
</body>
</html>
